<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHome IoT</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="theme-color" content="#2196F3">
    <link rel="manifest" href="manifest.json">
</head>
<body class="theme-light">
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <div class="logo">
                <span class="material-icons">home</span>
                <h1>SmartHome IoT</h1>
            </div>
            <div class="loading">
                <div class="loading-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p>ƒêang kh·ªüi ƒë·ªông...</p>
            </div>
            <div class="version">Phi√™n b·∫£n 1.2.3</div>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="auth-container" class="auth-container hidden">
        <!-- Login Screen -->
        <div id="login-screen" class="auth-screen active">
            <div class="auth-header">
                <button class="back-btn" onclick="goBack()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>ƒêƒÉng nh·∫≠p</h2>
            </div>
            <div class="auth-content">
                <div class="logo-section">
                    <span class="material-icons">home</span>
                    <h3>Ch√†o m·ª´ng tr·ªü l·∫°i!</h3>
                </div>
                <form class="auth-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>Email ho·∫∑c s·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" id="login-email" placeholder="example@email.com" required>
                    </div>
                    <div class="form-group">
                        <label>M·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('login-password')">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="remember-me">
                            <span class="checkmark"></span>
                            Ghi nh·ªõ ƒëƒÉng nh·∫≠p
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">ƒêƒÉng nh·∫≠p</button>
                </form>
                <div class="auth-links">
                    <a href="#" onclick="showScreen('forgot-password')">Qu√™n m·∫≠t kh·∫©u?</a>
                </div>
                <div class="divider">
                    <span>HO·∫∂C</span>
                </div>
                <button class="btn btn-google" onclick="loginWithGoogle()">
                    <span class="google-icon">G</span>
                    ƒêƒÉng nh·∫≠p v·ªõi Google
                </button>
                <div class="auth-footer">
                    <p>Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="showScreen('signup')">ƒêƒÉng k√Ω</a></p>
                </div>
            </div>
        </div>

        <!-- Sign Up Screen -->
        <div id="signup-screen" class="auth-screen">
            <div class="auth-header">
                <button class="back-btn" onclick="goBack()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>T·∫°o t√†i kho·∫£n</h2>
            </div>
            <div class="auth-content">
                <form class="auth-form" onsubmit="handleSignup(event)">
                    <div class="form-group">
                        <label>H·ªç v√† t√™n</label>
                        <input type="text" id="signup-name" placeholder="Nguyen Van A" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="signup-email" placeholder="example@email.com" required>
                    </div>
                    <div class="form-group">
                        <label>S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" id="signup-phone" placeholder="+84 901234567" required>
                    </div>
                    <div class="form-group">
                        <label>M·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="signup-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('signup-password')">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="signup-confirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('signup-confirm')">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="agree-terms" required>
                            <span class="checkmark"></span>
                            T√¥i ƒë·ªìng √Ω v·ªõi <a href="#">ƒêi·ªÅu kho·∫£n</a> v√† <a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">ƒêƒÉng k√Ω</button>
                </form>
                <div class="auth-footer">
                    <p>ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="showScreen('login')">ƒêƒÉng nh·∫≠p</a></p>
                </div>
            </div>
        </div>

        <!-- Forgot Password Screen -->
        <div id="forgot-password-screen" class="auth-screen">
            <div class="auth-header">
                <button class="back-btn" onclick="goBack()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>Qu√™n m·∫≠t kh·∫©u</h2>
            </div>
            <div class="auth-content">
                <div class="logo-section">
                    <span class="material-icons">vpn_key</span>
                    <h3>Kh√¥i ph·ª•c m·∫≠t kh·∫©u</h3>
                    <p>Nh·∫≠p email ho·∫∑c s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ nh·∫≠n m√£ x√°c nh·∫≠n kh√¥i ph·ª•c</p>
                </div>
                <form class="auth-form" onsubmit="handleForgotPassword(event)">
                    <div class="form-group">
                        <label>Email ho·∫∑c s·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" id="forgot-email" placeholder="example@email.com" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">G·ª≠i m√£ x√°c nh·∫≠n</button>
                </form>
                <div class="auth-footer">
                    <p><a href="#" onclick="showScreen('login')">Quay l·∫°i ƒëƒÉng nh·∫≠p</a></p>
                </div>
            </div>
        </div>

        <!-- OTP Verification Screen -->
        <div id="otp-screen" class="auth-screen">
            <div class="auth-header">
                <button class="back-btn" onclick="goBack()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>X√°c nh·∫≠n m√£ OTP</h2>
            </div>
            <div class="auth-content">
                <div class="logo-section">
                    <span class="material-icons">message</span>
                    <h3>Nh·∫≠p m√£ x√°c nh·∫≠n</h3>
                    <p>M√£ OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email<br><strong id="otp-email">example@email.com</strong></p>
                </div>
                <form class="auth-form" onsubmit="handleOTP(event)">
                    <div class="otp-inputs">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 0)">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 1)">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 2)">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 3)">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 4)">
                        <input type="text" maxlength="1" class="otp-input" oninput="moveToNext(this, 5)">
                    </div>
                    <div class="resend-timer">
                        <p>G·ª≠i l·∫°i m√£ sau <span id="countdown">00:45</span></p>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">X√°c nh·∫≠n</button>
                </form>
                <div class="auth-links">
                    <a href="#" onclick="resendOTP()">G·ª≠i l·∫°i m√£ OTP</a>
                    <a href="#" onclick="showScreen('forgot-password')">Thay ƒë·ªïi email</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="app-container hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="home-selector" onclick="showHomeSelector()">
                    <span id="current-home-name">Nh√† c·ªßa Anh</span>
                    <span class="material-icons">keyboard_arrow_down</span>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="showNotifications()">
                    <span class="material-icons">notifications</span>
                    <span class="badge" id="notification-badge">3</span>
                </button>
                <button class="header-btn voice-btn" onclick="startVoiceControl()">
                    <span class="material-icons">mic</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Screen -->
            <div id="home-screen" class="screen active">
                <!-- Weather Widget -->
                <div class="weather-widget">
                    <div class="weather-info">
                        <span class="weather-icon">‚òÄÔ∏è</span>
                        <div class="weather-details">
                            <div class="temperature">28¬∞C</div>
                            <div class="location">H√† N·ªôi, H√¥m nay</div>
                            <div class="description">N·∫Øng, gi√≥ nh·∫π</div>
                        </div>
                    </div>
                </div>

                <!-- Favorite Devices -->
                <section class="section">
                    <h3 class="section-title">Thi·∫øt b·ªã y√™u th√≠ch</h3>
                    <div class="device-grid" id="favorite-devices">
                        <!-- Devices will be populated by JS -->
                    </div>
                </section>

                <!-- Quick Scenes -->
                <section class="section">
                    <h3 class="section-title">K·ªãch b·∫£n nhanh</h3>
                    <div class="scene-grid" id="quick-scenes">
                        <!-- Scenes will be populated by JS -->
                    </div>
                </section>

                <!-- Today's Summary -->
                <section class="section">
                    <h3 class="section-title">H√¥m nay</h3>
                    <div class="summary-cards">
                        <div class="summary-card">
                            <span class="material-icons">bolt</span>
                            <div class="summary-info">
                                <div class="summary-label">ƒêi·ªán nƒÉng</div>
                                <div class="summary-value">45.2 kWh</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <span class="material-icons">attach_money</span>
                            <div class="summary-info">
                                <div class="summary-label">Chi ph√≠</div>
                                <div class="summary-value">~135,000 VNƒê</div>
                            </div>
                        </div>
                        <div class="summary-card trend-up">
                            <span class="material-icons">trending_up</span>
                            <div class="summary-info">
                                <div class="summary-label">So v·ªõi h√¥m qua</div>
                                <div class="summary-value">+12%</div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Device List Screen -->
            <div id="devices-screen" class="screen">
                <div class="screen-header">
                    <h2>Thi·∫øt b·ªã</h2>
                    <div class="header-actions">
                        <button class="header-btn" onclick="showDeviceSearch()">
                            <span class="material-icons">search</span>
                        </button>
                        <button class="header-btn" onclick="showDeviceSettings()">
                            <span class="material-icons">settings</span>
                        </button>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="search-bar" id="device-search" style="display: none;">
                    <div class="search-input">
                        <span class="material-icons">search</span>
                        <input type="text" placeholder="T√¨m thi·∫øt b·ªã..." oninput="filterDevices(this.value)">
                    </div>
                </div>

                <!-- Filter Bar -->
                <div class="filter-bar">
                    <select class="filter-select" onchange="filterByRoom(this.value)">
                        <option value="">üìç T·∫•t c·∫£ ph√≤ng</option>
                        <option value="living-room">üõãÔ∏è Ph√≤ng kh√°ch</option>
                        <option value="bedroom">üõèÔ∏è Ph√≤ng ng·ªß</option>
                        <option value="kitchen">üç≥ Nh√† b·∫øp</option>
                        <option value="bathroom">üöø Ph√≤ng t·∫Øm</option>
                    </select>
                    <select class="filter-select" onchange="filterByType(this.value)">
                        <option value="">üîß T·∫•t c·∫£ lo·∫°i</option>
                        <option value="light">üí° ƒê√®n</option>
                        <option value="ac">‚ùÑÔ∏è ƒêi·ªÅu h√≤a</option>
                        <option value="tv">üì∫ TV</option>
                        <option value="socket">üîå ·ªî c·∫Øm</option>
                        <option value="water_heater">üî• B√¨nh n√≥ng l·∫°nh</option>
                        <option value="towel_dryer">üßª M√°y s·∫•y khƒÉn</option>
                    </select>
                </div>

                <!-- Device List -->
                <div class="device-list" id="device-list">
                    <!-- Devices will be populated by JS -->
                </div>

                <!-- Add Device Button -->
                <button class="fab" onclick="showAddDevice()">
                    <span class="material-icons">add</span>
                </button>
            </div>

            <!-- Scenes Screen -->
            <div id="scenes-screen" class="screen">
                <div class="screen-header">
                    <h2>K·ªãch b·∫£n th√¥ng minh</h2>
                    <div class="header-actions">
                        <button class="header-btn" onclick="showSceneSearch()">
                            <span class="material-icons">search</span>
                        </button>
                        <button class="header-btn" onclick="showAddScene()">
                            <span class="material-icons">add</span>
                        </button>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="search-bar" id="scene-search" style="display: none;">
                    <div class="search-input">
                        <span class="material-icons">search</span>
                        <input type="text" placeholder="T√¨m k·ªãch b·∫£n..." oninput="filterScenes(this.value)">
                    </div>
                </div>

                <!-- Scene Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="showSceneTab('my-scenes')">K·ªãch b·∫£n c·ªßa t√¥i</button>
                    <button class="tab" onclick="showSceneTab('ai-suggestions')">G·ª£i √Ω AI</button>
                    <button class="tab" onclick="showSceneTab('automation-rules')">Quy t·∫Øc t·ª± ƒë·ªông</button>
                </div>

                <!-- My Scenes Tab -->
                <div id="my-scenes-tab" class="tab-content active">
                    <div class="scene-list" id="scene-list">
                        <!-- Scenes will be populated by JS -->
                    </div>
                </div>

                <!-- AI Suggestions Tab -->
                <div id="ai-suggestions-tab" class="tab-content">
                    <div class="ai-suggestions" id="ai-suggestions">
                        <!-- AI suggestions will be populated by JS -->
                    </div>
                </div>

                <!-- Automation Rules Tab -->
                <div id="automation-rules-tab" class="tab-content">
                    <div class="automation-rules-list" id="automation-rules-list">
                        <!-- Automation rules will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Analytics Screen -->
            <div id="analytics-screen" class="screen">
                <div class="screen-header">
                    <h2>Th·ªëng k√™ ƒëi·ªán nƒÉng</h2>
                    <div class="header-actions">
                        <button class="header-btn" onclick="showAnalyticsChart()">
                            <span class="material-icons">bar_chart</span>
                        </button>
                        <button class="header-btn" onclick="showAnalyticsSettings()">
                            <span class="material-icons">settings</span>
                        </button>
                    </div>
                </div>

                <!-- Period Selector -->
                <div class="period-selector">
                    <button class="period-btn active" onclick="setPeriod('today')">H√¥m nay</button>
                    <button class="period-btn" onclick="setPeriod('week')">Tu·∫ßn</button>
                    <button class="period-btn" onclick="setPeriod('month')">Th√°ng</button>
                    <button class="period-btn" onclick="setPeriod('year')">NƒÉm</button>
                </div>

                <!-- Overview Cards -->
                <div class="analytics-overview">
                    <div class="analytics-card">
                        <div class="analytics-icon">‚ö°</div>
                        <div class="analytics-info">
                            <div class="analytics-value">45.2 kWh</div>
                            <div class="analytics-label">T·ªïng ti√™u th·ª•</div>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-icon">üí∞</div>
                        <div class="analytics-info">
                            <div class="analytics-value">135,000 VNƒê</div>
                            <div class="analytics-label">Chi ph√≠</div>
                        </div>
                    </div>
                    <div class="analytics-card trend">
                        <div class="analytics-icon">üìà</div>
                        <div class="analytics-info">
                            <div class="analytics-value">+12%</div>
                            <div class="analytics-label">So v·ªõi h√¥m qua</div>
                        </div>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="chart-container">
                    <canvas id="energy-chart"></canvas>
                </div>

                <!-- Top Devices -->
                <section class="section">
                    <h3 class="section-title">Top thi·∫øt b·ªã ti√™u th·ª•</h3>
                    <div class="top-devices" id="top-devices">
                        <!-- Top devices will be populated by JS -->
                    </div>
                </section>

                <!-- Recommendations -->
                <section class="section">
                    <h3 class="section-title">ƒê·ªÅ xu·∫•t ti·∫øt ki·ªám</h3>
                    <div class="recommendations" id="recommendations">
                        <!-- Recommendations will be populated by JS -->
                    </div>
                </section>
            </div>

            <!-- Settings Screen -->
            <div id="settings-screen" class="screen">
                <div class="screen-header">
                    <h2>C√†i ƒë·∫∑t</h2>
                </div>

                <!-- Profile Section -->
                <div class="profile-section">
                    <div class="profile-info">
                        <div class="profile-avatar">
                            <span class="material-icons">person</span>
                        </div>
                        <div class="profile-details">
                            <div class="profile-name">Nguy·ªÖn VƒÉn A</div>
                            <div class="profile-email">user@example.com</div>
                        </div>
                    </div>
                    <button class="btn btn-outline" onclick="editProfile()">Ch·ªânh s·ª≠a h·ªì s∆°</button>
                </div>

                <!-- Settings Groups -->
                <div class="settings-groups">
                    <div class="settings-group">
                        <h4 class="group-title">T√†i kho·∫£n</h4>
                        <div class="setting-item" onclick="changePassword()">
                            <span class="material-icons">lock</span>
                            <span class="setting-label">ƒê·ªïi m·∫≠t kh·∫©u</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showSecurity()">
                            <span class="material-icons">security</span>
                            <span class="setting-label">B·∫£o m·∫≠t 2 l·ªõp</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showBackup()">
                            <span class="material-icons">backup</span>
                            <span class="setting-label">Sao l∆∞u & kh√¥i ph·ª•c</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">H·ªá th·ªëng</h4>
                        <div class="setting-item" onclick="manageHomes()">
                            <span class="material-icons">home</span>
                            <span class="setting-label">Qu·∫£n l√Ω nh√† & ph√≤ng</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="notificationSettings()">
                            <span class="material-icons">notifications</span>
                            <span class="setting-label">C√†i ƒë·∫∑t th√¥ng b√°o</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="themeSettings()">
                            <span class="material-icons">palette</span>
                            <span class="setting-label">Giao di·ªán s√°ng/t·ªëi</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="languageSettings()">
                            <span class="material-icons">language</span>
                            <span class="setting-label">Ng√¥n ng·ªØ</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">T·ª± ƒë·ªông h√≥a</h4>
                        <div class="setting-item" onclick="showAutomationRules()">
                            <span class="material-icons">smart_toy</span>
                            <span class="setting-label">Quy t·∫Øc t·ª± ƒë·ªông</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showSmartSuggestions()">
                            <span class="material-icons">lightbulb</span>
                            <span class="setting-label">G·ª£i √Ω th√¥ng minh</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showEnergyOptimization()">
                            <span class="material-icons">eco</span>
                            <span class="setting-label">T·ªëi ∆∞u h√≥a nƒÉng l∆∞·ª£ng</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showDeviceSchedules()">
                            <span class="material-icons">schedule</span>
                            <span class="setting-label">L·ªãch tr√¨nh thi·∫øt b·ªã</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">Qu·∫£n l√Ω thi·∫øt b·ªã</h4>
                        <div class="setting-item" onclick="showDeviceHealth()">
                            <span class="material-icons">health_and_safety</span>
                            <span class="setting-label">T√¨nh tr·∫°ng thi·∫øt b·ªã</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showMaintenanceSchedule()">
                            <span class="material-icons">build</span>
                            <span class="setting-label">L·ªãch b·∫£o tr√¨</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showEnergyReports()">
                            <span class="material-icons">assessment</span>
                            <span class="setting-label">B√°o c√°o nƒÉng l∆∞·ª£ng</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">T√≠ch h·ª£p</h4>
                        <div class="setting-item" onclick="voiceSettings()">
                            <span class="material-icons">mic</span>
                            <span class="setting-label">ƒêi·ªÅu khi·ªÉn gi·ªçng n√≥i</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="otaSettings()">
                            <span class="material-icons">system_update</span>
                            <span class="setting-label">C·∫≠p nh·∫≠t OTA</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>
                </div>

                <!-- Logout Button -->
                <button class="btn btn-danger btn-full logout-btn" onclick="logout()">
                    ƒêƒÉng xu·∫•t
                </button>

                <!-- Version Info -->
                <div class="version-info">
                    Phi√™n b·∫£n 1.2.3 (Build 456)
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="showScreen('home')">
                <span class="material-icons">home</span>
                <span class="nav-label">Trang ch·ªß</span>
            </button>
            <button class="nav-item" onclick="showScreen('devices')">
                <span class="material-icons">devices</span>
                <span class="nav-label">Thi·∫øt b·ªã</span>
            </button>
            <button class="nav-item" onclick="showScreen('scenes')">
                <span class="material-icons">movie</span>
                <span class="nav-label">K·ªãch b·∫£n</span>
            </button>
            <button class="nav-item" onclick="showScreen('analytics')">
                <span class="material-icons">analytics</span>
                <span class="nav-label">Th·ªëng k√™</span>
            </button>
            <button class="nav-item" onclick="showScreen('settings')">
                <span class="material-icons">settings</span>
                <span class="nav-label">C√†i ƒë·∫∑t</span>
            </button>
        </nav>
    </div>

    <!-- Modals and Overlays -->
    <div id="modal-overlay" class="modal-overlay">
        <!-- Device Control Modal -->
        <div id="device-control-modal" class="modal">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h3 id="device-control-title">ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã</h3>
                <button class="header-btn" onclick="showDeviceSettings()">
                    <span class="material-icons">settings</span>
                </button>
            </div>
            <div class="modal-content" id="device-control-content">
               <!-- Content will be populated by JS -->
           </div>
       </div>

       <!-- Add Device Modal -->
       <div id="add-device-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>Th√™m thi·∫øt b·ªã m·ªõi</h3>
           </div>
           <div class="modal-content">
               <div class="add-device-methods">
                   <div class="method-card">
                       <div class="qr-scanner">
                           <span class="material-icons">qr_code_scanner</span>
                           <h4>Qu√©t m√£ QR thi·∫øt b·ªã</h4>
                           <p>ƒê∆∞a camera v·ªÅ ph√≠a m√£ QR</p>
                       </div>
                       <button class="btn btn-primary" onclick="startQRScan()">B·∫Øt ƒë·∫ßu qu√©t</button>
                   </div>
                   
                   <div class="divider"><span>HO·∫∂C</span></div>
                   
                   <div class="form-group">
                       <label>Nh·∫≠p m√£ thi·∫øt b·ªã</label>
                       <input type="text" placeholder="ABC123DEF456" id="device-code">
                   </div>
                   
                   <div class="divider"><span>HO·∫∂C</span></div>
                   
                   <div class="nearby-devices">
                       <h4>T√¨m thi·∫øt b·ªã g·∫ßn ƒë√≥</h4>
                       <div class="scanning-status">
                           <span class="material-icons spin">refresh</span>
                           <span>ƒêang qu√©t...</span>
                       </div>
                       <div class="nearby-list" id="nearby-devices-list">
                           <!-- Nearby devices will be populated by JS -->
                       </div>
                   </div>
                   
                   <button class="btn btn-outline btn-full" onclick="refreshNearbyDevices()">
                       L√†m m·ªõi
                   </button>
               </div>
           </div>
       </div>

       <!-- Notifications Modal -->
       <div id="notifications-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>Th√¥ng b√°o</h3>
               <div class="header-actions">
                   <button class="header-btn" onclick="searchNotifications()">
                       <span class="material-icons">search</span>
                   </button>
                   <button class="header-btn" onclick="notificationSettings()">
                       <span class="material-icons">settings</span>
                   </button>
                   <button class="header-btn" onclick="clearAllNotifications()">
                       <span class="material-icons">delete</span>
                   </button>
               </div>
           </div>
           <div class="modal-content">
               <!-- Notification Filters -->
               <div class="notification-filters">
                   <button class="filter-btn active" onclick="filterNotifications('all')">T·∫•t c·∫£</button>
                   <button class="filter-btn" onclick="filterNotifications('warning')">‚ö†Ô∏è C·∫£nh b√°o</button>
                   <button class="filter-btn" onclick="filterNotifications('info')">‚ÑπÔ∏è Th√¥ng tin</button>
                   <button class="filter-btn" onclick="filterNotifications('success')">‚úÖ Th√†nh c√¥ng</button>
               </div>
               
               <!-- Notifications List -->
               <div class="notifications-list" id="notifications-list">
                   <!-- Notifications will be populated by JS -->
               </div>
           </div>
       </div>

       <!-- Automation Rules Modal -->
       <div id="automation-rules-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>Quy t·∫Øc t·ª± ƒë·ªông</h3>
               <div class="header-actions">
                   <button class="header-btn" onclick="addAutomationRule()">
                       <span class="material-icons">add</span>
                   </button>
               </div>
           </div>
           <div class="modal-content">
               <div class="automation-rules-list" id="automation-rules-modal-list">
                   <!-- Automation rules will be populated by JS -->
               </div>
           </div>
       </div>

       <!-- Energy Optimization Modal -->
       <div id="energy-optimization-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>T·ªëi ∆∞u h√≥a nƒÉng l∆∞·ª£ng</h3>
           </div>
           <div class="modal-content">
               <div class="optimization-summary">
                   <div class="summary-card">
                       <span class="material-icons">eco</span>
                       <div class="summary-info">
                           <div class="summary-value" id="potential-savings">25%</div>
                           <div class="summary-label">Ti·∫øt ki·ªám d·ª± ki·∫øn</div>
                       </div>
                   </div>
               </div>
               
               <div class="optimization-recommendations" id="optimization-recommendations">
                   <!-- Recommendations will be populated by JS -->
               </div>
               
               <div class="optimization-actions">
                   <button class="btn btn-primary btn-full" onclick="applyAllOptimizations()">
                       √Åp d·ª•ng t·∫•t c·∫£ t·ªëi ∆∞u h√≥a
                   </button>
               </div>
           </div>
       </div>

       <!-- Device Timer Modal -->
       <div id="device-timer-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>H·∫πn gi·ªù thi·∫øt b·ªã</h3>
           </div>
           <div class="modal-content">
               <div class="timer-setup">
                   <div class="form-group">
                       <label>Th·ªùi gian (ph√∫t)</label>
                       <input type="number" id="timer-minutes" min="1" max="1440" value="30" placeholder="30">
                   </div>
                   <div class="form-group">
                       <label>H√†nh ƒë·ªông khi h·∫øt gi·ªù</label>
                       <select id="timer-action">
                           <option value="turn_off">T·∫Øt thi·∫øt b·ªã</option>
                           <option value="turn_on">B·∫≠t thi·∫øt b·ªã</option>
                           <option value="notify_only">Ch·ªâ th√¥ng b√°o</option>
                       </select>
                   </div>
                   <div class="timer-actions">
                       <button class="btn btn-primary btn-full" onclick="setDeviceTimerFromModal()">
                           ƒê·∫∑t h·∫πn gi·ªù
                       </button>
                       <button class="btn btn-outline btn-full" onclick="cancelDeviceTimerFromModal()">
                           H·ªßy h·∫πn gi·ªù
                       </button>
                   </div>
               </div>
           </div>
       </div>

       <!-- Device Schedule Modal -->
       <div id="device-schedule-modal" class="modal">
           <div class="modal-header">
               <button class="back-btn" onclick="closeModal()">
                   <span class="material-icons">arrow_back</span>
               </button>
               <h3>L·ªãch tr√¨nh thi·∫øt b·ªã</h3>
           </div>
           <div class="modal-content">
               <div class="schedule-setup">
                   <div class="form-group">
                       <label>T√™n l·ªãch tr√¨nh</label>
                       <input type="text" id="schedule-name" placeholder="L·ªãch tr√¨nh m·ªõi">
                   </div>
                   <div class="schedule-rules" id="schedule-rules">
                       <!-- Schedule rules will be added dynamically -->
                   </div>
                   <button class="btn btn-outline" onclick="addScheduleRule()">
                       <span class="material-icons">add</span>
                       Th√™m quy t·∫Øc
                   </button>
                   <div class="schedule-actions">
                       <button class="btn btn-primary btn-full" onclick="saveDeviceSchedule()">
                           L∆∞u l·ªãch tr√¨nh
                       </button>
                   </div>
               </div>
           </div>
       </div>

       <!-- Loading Modal -->
       <div id="loading-modal" class="modal loading-modal">
           <div class="loading-content">
               <div class="spinner"></div>
               <p id="loading-text">ƒêang x·ª≠ l√Ω...</p>
           </div>
       </div>

       <!-- Confirmation Modal -->
       <div id="confirmation-modal" class="modal confirmation-modal">
           <div class="modal-content">
               <div class="confirmation-icon">
                   <span class="material-icons" id="confirmation-icon">warning</span>
               </div>
               <h3 id="confirmation-title">X√°c nh·∫≠n</h3>
               <p id="confirmation-message">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
               <div class="confirmation-actions">
                   <button class="btn btn-outline" onclick="closeModal()">H·ªßy b·ªè</button>
                   <button class="btn btn-primary" id="confirmation-confirm" onclick="confirmAction()">X√°c nh·∫≠n</button>
               </div>
           </div>
       </div>
   </div>

   <!-- Toast Notifications -->
   <div id="toast-container" class="toast-container"></div>

   <!-- Voice Control Overlay -->
   <div id="voice-overlay" class="voice-overlay">
       <div class="voice-content">
           <div class="voice-animation">
               <div class="voice-circle"></div>
               <div class="voice-circle"></div>
               <div class="voice-circle"></div>
           </div>
           <h3>ƒêang nghe...</h3>
           <p id="voice-transcript">H√£y n√≥i l·ªánh c·ªßa b·∫°n</p>
           <button class="btn btn-outline" onclick="stopVoiceControl()">D·ª´ng</button>
       </div>
   </div>

   <!-- PWA Install Prompt -->
   <div id="install-prompt" class="install-prompt">
       <div class="install-content">
           <span class="material-icons">get_app</span>
           <div class="install-text">
               <h4>C√†i ƒë·∫∑t SmartHome IoT</h4>
               <p>Truy c·∫≠p nhanh h∆°n t·ª´ m√†n h√¨nh ch√≠nh</p>
           </div>
           <button class="btn btn-primary btn-sm" onclick="installPWA()">C√†i ƒë·∫∑t</button>
           <button class="btn btn-text btn-sm" onclick="dismissInstall()">B·ªè qua</button>
       </div>
   </div>

   <!-- Scripts -->
   <script src="js/utils.js"></script>
   <script src="js/data.js"></script>
   <script src="js/components.js"></script>
   <script src="js/app.js"></script>
 <!-- Edit Profile Modal -->
<div id="edit-profile-modal" class="modal">
    <div class="modal-header">
        <button class="back-btn" onclick="closeModal()">
            <span class="material-icons">arrow_back</span>
        </button>
        <h3>Ch·ªânh s·ª≠a h·ªì s∆°</h3>
    </div>
    <div class="modal-content">
        <div class="form-group">
            <label>H·ªç v√† t√™n</label>
            <input type="text" id="edit-name" placeholder="Nguy·ªÖn VƒÉn A">
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="edit-email" placeholder="user@example.com">
        </div>
        <div class="form-group">
            <label>S·ªë ƒëi·ªán tho·∫°i</label>
            <input type="tel" id="edit-phone" placeholder="+84901234567">
        </div>
        <div class="form-group">
            <label>·∫¢nh ƒë·∫°i di·ªán</label>
            <input type="file" id="edit-avatar" accept="image/*">
        </div>
        <button class="btn btn-primary btn-full" onclick="saveProfile()">L∆∞u thay ƒë·ªïi</button>
    </div>
</div>

<!-- Change Password Modal -->
<div id="change-password-modal" class="modal">
    <div class="modal-header">
        <button class="back-btn" onclick="closeModal()">
            <span class="material-icons">arrow_back</span>
        </button>
        <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>
    </div>
    <div class="modal-content">
        <div class="form-group">
            <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
            <div class="password-input">
                <input type="password" id="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                <button type="button" class="toggle-password" onclick="togglePassword('current-password')">
                    <span class="material-icons">visibility</span>
                </button>
            </div>
        </div>
        <div class="form-group">
            <label>M·∫≠t kh·∫©u m·ªõi</label>
            <div class="password-input">
                <input type="password" id="new-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                <button type="button" class="toggle-password" onclick="togglePassword('new-password')">
                    <span class="material-icons">visibility</span>
                </button>
            </div>
        </div>
        <div class="form-group">
            <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
            <div class="password-input">
                <input type="password" id="confirm-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                <button type="button" class="toggle-password" onclick="togglePassword('confirm-password')">
                    <span class="material-icons">visibility</span>
                </button>
            </div>
        </div>
        <button class="btn btn-primary btn-full" onclick="changePasswordSubmit()">ƒê·ªïi m·∫≠t kh·∫©u</button>
    </div>
</div>

<!-- Theme Settings Modal -->
<div id="theme-settings-modal" class="modal">
    <div class="modal-header">
        <button class="back-btn" onclick="closeModal()">
            <span class="material-icons">arrow_back</span>
        </button>
        <h3>C√†i ƒë·∫∑t giao di·ªán</h3>
    </div>
    <div class="modal-content">
        <div class="theme-options">
            <div class="theme-option" onclick="setTheme('light')">
                <div class="theme-preview theme-preview-light"></div>
                <div class="theme-info">
                    <h4>S√°ng</h4>
                    <p>Giao di·ªán s√°ng, d·ªÖ nh√¨n ban ng√†y</p>
                </div>
                <span class="material-icons theme-check">check_circle</span>
            </div>
            
            <div class="theme-option" onclick="setTheme('dark')">
                <div class="theme-preview theme-preview-dark"></div>
                <div class="theme-info">
                    <h4>T·ªëi</h4>
                    <p>Giao di·ªán t·ªëi, d·ªÖ ch·ªãu cho m·∫Øt</p>
                </div>
                <span class="material-icons theme-check">check_circle</span>
            </div>
            
            <div class="theme-option" onclick="setTheme('auto')">
                <div class="theme-preview theme-preview-auto"></div>
                <div class="theme-info">
                    <h4>T·ª± ƒë·ªông</h4>
                    <p>Theo c√†i ƒë·∫∑t h·ªá th·ªëng</p>
                </div>
                <span class="material-icons theme-check">check_circle</span>
            </div>
            
            <div class="theme-option" onclick="setTheme('high-contrast')">
                <div class="theme-preview theme-preview-contrast"></div>
                <div class="theme-info">
                    <h4>T∆∞∆°ng ph·∫£n cao</h4>
                    <p>D·ªÖ nh√¨n h∆°n cho ng∆∞·ªùi khi·∫øm th·ªã</p>
                </div>
                <span class="material-icons theme-check">check_circle</span>
            </div>
        </div>
    </div>
</div>

<!-- Language Settings Modal -->
<div id="language-settings-modal" class="modal">
    <div class="modal-header">
        <button class="back-btn" onclick="closeModal()">
            <span class="material-icons">arrow_back</span>
        </button>
        <h3>C√†i ƒë·∫∑t ng√¥n ng·ªØ</h3>
    </div>
    <div class="modal-content">
        <div class="language-options">
            <div class="language-option" onclick="setLanguage('vi')">
                <span class="language-flag">üáªüá≥</span>
                <div class="language-info">
                    <h4>Ti·∫øng Vi·ªát</h4>
                    <p>Vietnamese</p>
                </div>
                <span class="material-icons language-check">check_circle</span>
            </div>
            
            <div class="language-option" onclick="setLanguage('en')">
                <span class="language-flag">üá∫üá∏</span>
                <div class="language-info">
                    <h4>English</h4>
                    <p>English (US)</p>
                </div>
                <span class="material-icons language-check">check_circle</span>
            </div>
        </div>
    </div>
</div>

<!-- Notification Settings Modal -->
<div id="notification-settings-modal" class="modal">
    <div class="modal-header">
        <button class="back-btn" onclick="closeModal()">
            <span class="material-icons">arrow_back</span>
        </button>
        <h3>C√†i ƒë·∫∑t th√¥ng b√°o</h3>
    </div>
    <div class="modal-content">
        <div class="notification-settings">
            <div class="setting-group">
                <h4>Lo·∫°i th√¥ng b√°o</h4>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">C·∫£nh b√°o thi·∫øt b·ªã</div>
                        <div class="setting-desc">Th√¥ng b√°o khi thi·∫øt b·ªã offline ho·∫∑c l·ªói</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked onchange="updateNotificationSetting('warnings', this.checked)">
                        <span class="slider-switch"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">K·ªãch b·∫£n</div>
                        <div class="setting-desc">Th√¥ng b√°o khi k·ªãch b·∫£n ƒë∆∞·ª£c th·ª±c hi·ªán</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked onchange="updateNotificationSetting('scenes', this.checked)">
                        <span class="slider-switch"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">C·∫≠p nh·∫≠t</div>
                        <div class="setting-desc">Th√¥ng b√°o v·ªÅ c·∫≠p nh·∫≠t ·ª©ng d·ª•ng v√† firmware</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked onchange="updateNotificationSetting('updates', this.checked)">
                        <span class="slider-switch"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">G·ª£i √Ω th√¥ng minh</div>
                        <div class="setting-desc">G·ª£i √Ω t·ªëi ∆∞u h√≥a t·ª´ AI</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked onchange="updateNotificationSetting('suggestions', this.checked)">
                        <span class="slider-switch"></span>
                    </label>
                </div>
            </div>
            
            <div class="setting-group">
                <h4>Gi·ªù im l·∫∑ng</h4>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">B·∫≠t gi·ªù im l·∫∑ng</div>
                        <div class="setting-desc">T·∫Øt th√¥ng b√°o trong kho·∫£ng th·ªùi gian n√†y</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider-switch"></span>
                    </label>
                </div>
                
                <div class="time-range">
                    <div class="form-group">
                        <label>T·ª´</label>
                        <input type="time" value="22:00">
                    </div>
                    <div class="form-group">
                        <label>ƒê·∫øn</label>
                        <input type="time" value="07:00">
                   </div>
               </div>
           </div>
       </div>
   </div>
</div>

<!-- Voice Settings Modal -->
<div id="voice-settings-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>C√†i ƒë·∫∑t gi·ªçng n√≥i</h3>
   </div>
   <div class="modal-content">
       <div class="voice-settings">
           <div class="setting-group">
               <h4>Nh·∫≠n d·∫°ng gi·ªçng n√≥i</h4>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">B·∫≠t ƒëi·ªÅu khi·ªÉn gi·ªçng n√≥i</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked onchange="updateVoiceSetting('enabled', this.checked)">
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="form-group">
                   <label>ƒê·ªô nh·∫°y</label>
                   <select onchange="updateVoiceSetting('sensitivity', this.value)">
                       <option value="low">Th·∫•p</option>
                       <option value="medium" selected>Trung b√¨nh</option>
                       <option value="high">Cao</option>
                   </select>
               </div>
               
               <div class="form-group">
                   <label>Ng√¥n ng·ªØ nh·∫≠n d·∫°ng</label>
                   <select onchange="updateVoiceSetting('language', this.value)">
                       <option value="vi-VN" selected>Ti·∫øng Vi·ªát</option>
                       <option value="en-US">English (US)</option>
                   </select>
               </div>
               
               <div class="form-group">
                   <label>Th·ªùi gian ch·ªù (gi√¢y)</label>
                   <input type="range" min="3" max="10" value="5" 
                          oninput="updateVoiceSetting('timeout', this.value * 1000)">
                   <span>5 gi√¢y</span>
               </div>
           </div>
           
           <div class="setting-group">
               <h4>Ph·∫£n h·ªìi gi·ªçng n√≥i</h4>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">T·∫Øt ti·∫øng ph·∫£n h·ªìi</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" onchange="updateVoiceSetting('muteResponse', this.checked)">
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="form-group">
                   <label>Gi·ªçng ph·∫£n h·ªìi</label>
                   <select onchange="updateVoiceSetting('responseVoice', this.value)">
                       <option value="female" selected>N·ªØ</option>
                       <option value="male">Nam</option>
                   </select>
               </div>
           </div>
           
           <div class="voice-test">
               <button class="btn btn-outline btn-full" onclick="testVoiceRecognition()">
                   <span class="material-icons">mic</span>
                   Ki·ªÉm tra nh·∫≠n d·∫°ng gi·ªçng n√≥i
               </button>
           </div>
       </div>
   </div>
</div>

<!-- OTA Settings Modal -->
<div id="ota-settings-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>C·∫≠p nh·∫≠t OTA</h3>
   </div>
   <div class="modal-content">
       <div class="ota-settings">
           <div class="current-version">
               <div class="version-info">
                   <h4>Phi√™n b·∫£n hi·ªán t·∫°i</h4>
                   <p class="version-number">v1.2.3 (Build 456)</p>
                   <p class="version-date">C·∫≠p nh·∫≠t: 15/06/2025</p>
               </div>
               <button class="btn btn-primary" onclick="checkForUpdates()">
                   Ki·ªÉm tra c·∫≠p nh·∫≠t
               </button>
           </div>
           
           <div class="auto-update-settings">
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">T·ª± ƒë·ªông c·∫≠p nh·∫≠t ·ª©ng d·ª•ng</div>
                       <div class="setting-desc">T·ª± ƒë·ªông t·∫£i v√† c√†i ƒë·∫∑t b·∫£n c·∫≠p nh·∫≠t m·ªõi</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">T·ª± ƒë·ªông c·∫≠p nh·∫≠t thi·∫øt b·ªã</div>
                       <div class="setting-desc">T·ª± ƒë·ªông c·∫≠p nh·∫≠t firmware cho thi·∫øt b·ªã</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">Ch·ªâ qua WiFi</div>
                       <div class="setting-desc">Ch·ªâ t·∫£i c·∫≠p nh·∫≠t khi k·∫øt n·ªëi WiFi</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">Khi ƒëang s·∫°c</div>
                       <div class="setting-desc">Ch·ªâ c·∫≠p nh·∫≠t khi thi·∫øt b·ªã ƒëang s·∫°c</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox">
                       <span class="slider-switch"></span>
                   </label>
               </div>
           </div>
           
           <div class="update-history">
               <h4>L·ªãch s·ª≠ c·∫≠p nh·∫≠t</h4>
               <div class="history-list">
                   <div class="history-item">
                       <div class="history-info">
                           <div class="history-version">v1.2.3</div>
                           <div class="history-date">15/06/2025</div>
                       </div>
                       <div class="history-desc">C·∫£i thi·ªán hi·ªáu su·∫•t v√† s·ª≠a l·ªói</div>
                   </div>
                   <div class="history-item">
                       <div class="history-info">
                           <div class="history-version">v1.2.2</div>
                           <div class="history-date">01/06/2025</div>
                       </div>
                       <div class="history-desc">Th√™m t√≠nh nƒÉng ƒëi·ªÅu khi·ªÉn gi·ªçng n√≥i</div>
                   </div>
               </div>
           </div>
       </div>
   </div>
</div>

<!-- Manage Homes Modal -->
<div id="manage-homes-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>Qu·∫£n l√Ω nh√† & ph√≤ng</h3>
       <button class="header-btn" onclick="addNewHome()">
           <span class="material-icons">add</span>
       </button>
   </div>
   <div class="modal-content" id="manage-homes-content">
       <!-- Content will be populated by JS -->
   </div>
</div>

<!-- Add Home Modal -->
<div id="add-home-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>Th√™m nh√† m·ªõi</h3>
   </div>
   <div class="modal-content">
       <div class="form-group">
           <label>T√™n nh√†</label>
           <input type="text" id="home-name" placeholder="Nh√† c·ªßa t√¥i">
       </div>
       <div class="form-group">
           <label>ƒê·ªãa ch·ªâ</label>
           <input type="text" id="home-address" placeholder="123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM">
       </div>
       <div class="form-group">
           <label>M√¥ t·∫£</label>
           <textarea id="home-description" placeholder="M√¥ t·∫£ v·ªÅ ng√¥i nh√†"></textarea>
       </div>
       <button class="btn btn-primary btn-full" onclick="saveNewHome()">Th√™m nh√†</button>
   </div>
</div>

<!-- QR Scanner Modal -->
<div id="qr-scanner-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>Qu√©t m√£ QR</h3>
   </div>
   <div class="modal-content">
       <div class="qr-scanner-container">
           <video id="qr-video" autoplay></video>
           <div class="qr-overlay">
               <div class="qr-frame"></div>
               <p>ƒê∆∞a camera v·ªÅ ph√≠a m√£ QR thi·∫øt b·ªã</p>
           </div>
       </div>
   </div>
</div>

<!-- Add Scene Modal -->
<div id="add-scene-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>T·∫°o k·ªãch b·∫£n m·ªõi</h3>
   </div>
   <div class="modal-content">
       <div class="scene-builder">
           <div class="form-group">
               <label>T√™n k·ªãch b·∫£n</label>
               <input type="text" id="scene-name" placeholder="V·ªÅ nh√†">
           </div>
           
           <div class="form-group">
               <label>Bi·ªÉu t∆∞·ª£ng</label>
               <div class="icon-selector">
                   <input type="radio" name="scene-icon" value="üè†" id="icon-home" checked>
                   <label for="icon-home">üè†</label>
                   
                   <input type="radio" name="scene-icon" value="üò¥" id="icon-sleep">
                   <label for="icon-sleep">üò¥</label>
                   
                   <input type="radio" name="scene-icon" value="üåÖ" id="icon-morning">
                   <label for="icon-morning">üåÖ</label>
                   
                   <input type="radio" name="scene-icon" value="üåô" id="icon-night">
                   <label for="icon-night">üåô</label>
                   
                   <input type="radio" name="scene-icon" value="üé¨" id="icon-movie">
                   <label for="icon-movie">üé¨</label>
                   
                   <input type="radio" name="scene-icon" value="üõÅ" id="icon-bath">
                   <label for="icon-bath">üõÅ</label>
               </div>
           </div>
           
           <div class="form-group">
               <label>M√¥ t·∫£</label>
               <textarea id="scene-description" placeholder="M√¥ t·∫£ k·ªãch b·∫£n"></textarea>
           </div>
           
           <div class="scene-devices">
               <h4>Ch·ªçn thi·∫øt b·ªã</h4>
               <div id="scene-device-list">
                   <!-- Devices will be populated by JS -->
               </div>
           </div>
           
           <button class="btn btn-primary btn-full" onclick="saveNewScene()">T·∫°o k·ªãch b·∫£n</button>
       </div>
   </div>
</div>

<!-- Analytics Chart Modal -->
<div id="analytics-chart-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>Bi·ªÉu ƒë·ªì chi ti·∫øt</h3>
       <div class="header-actions">
           <button class="header-btn" onclick="exportChart()">
               <span class="material-icons">download</span>
           </button>
       </div>
   </div>
   <div class="modal-content">
       <div class="chart-controls">
           <select id="chart-type" onchange="updateChartType()">
               <option value="line">Bi·ªÉu ƒë·ªì ƒë∆∞·ªùng</option>
               <option value="bar">Bi·ªÉu ƒë·ªì c·ªôt</option>
               <option value="pie">Bi·ªÉu ƒë·ªì tr√≤n</option>
           </select>
           
           <select id="chart-period" onchange="updateChartPeriod()">
               <option value="today">H√¥m nay</option>
               <option value="week" selected>Tu·∫ßn n√†y</option>
               <option value="month">Th√°ng n√†y</option>
               <option value="year">NƒÉm n√†y</option>
           </select>
       </div>
       
       <div class="detailed-chart-container">
           <canvas id="detailed-chart" width="400" height="300"></canvas>
       </div>
       
       <div class="chart-legend">
           <div class="legend-item">
               <span class="legend-color" style="background: #2196F3;"></span>
               <span>T·ªïng ti√™u th·ª•</span>
           </div>
           <div class="legend-item">
               <span class="legend-color" style="background: #4CAF50;"></span>
               <span>Ti·∫øt ki·ªám</span>
           </div>
           <div class="legend-item">
               <span class="legend-color" style="background: #FF9800;"></span>
               <span>Cao ƒëi·ªÉm</span>
           </div>
       </div>
   </div>
</div>

<!-- Analytics Settings Modal -->
<div id="analytics-settings-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>C√†i ƒë·∫∑t th·ªëng k√™</h3>
   </div>
   <div class="modal-content">
       <div class="analytics-settings">
           <div class="setting-group">
               <h4>Gi√° ƒëi·ªán</h4>
               
               <div class="form-group">
                   <label>Gi√° ƒëi·ªán (VNƒê/kWh)</label>
                   <input type="number" id="electricity-cost" value="3000" min="1000" max="10000" step="100">
               </div>
               
               <div class="form-group">
                   <label>ƒê∆°n v·ªã ti·ªÅn t·ªá</label>
                   <select id="currency">
                       <option value="VND" selected>VNƒê (Vi·ªát Nam ƒê·ªìng)</option>
                       <option value="USD">USD (US Dollar)</option>
                   </select>
               </div>
           </div>
           
           <div class="setting-group">
               <h4>C·∫£nh b√°o</h4>
               
               <div class="form-group">
                   <label>Ng∆∞·ª°ng c·∫£nh b√°o (%)</label>
                   <input type="range" id="alert-threshold" min="100" max="200" value="150" 
                          oninput="document.getElementById('threshold-value').textContent = this.value + '%'">
                   <span id="threshold-value">150%</span>
                   <small>C·∫£nh b√°o khi ti√™u th·ª• v∆∞·ª£t qu√° % so v·ªõi trung b√¨nh</small>
               </div>
               
               <div class="form-group">
                   <label>M·ª•c ti√™u ti·∫øt ki·ªám (%)</label>
                   <input type="range" id="savings-goal" min="5" max="50" value="20"
                          oninput="document.getElementById('savings-value').textContent = this.value + '%'">
                   <span id="savings-value">20%</span>
               </div>
           </div>
           
           <div class="setting-group">
               <h4>B√°o c√°o</h4>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">B√°o c√°o h√†ng tu·∫ßn</div>
                       <div class="setting-desc">G·ª≠i b√°o c√°o t·ªïng k·∫øt qua email</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">B√°o c√°o h√†ng th√°ng</div>
                       <div class="setting-desc">B√°o c√°o chi ti·∫øt cu·ªëi th√°ng</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
           </div>
           
           <button class="btn btn-primary btn-full" onclick="saveAnalyticsSettings()">L∆∞u c√†i ƒë·∫∑t</button>
       </div>
   </div>
</div>

<!-- Device Settings Modal -->
<div id="device-settings-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>C√†i ƒë·∫∑t thi·∫øt b·ªã</h3>
   </div>
   <div class="modal-content">
       <div class="device-settings">
           <div class="setting-group">
               <h4>K·∫øt n·ªëi</h4>
               
               <div class="form-group">
                   <label>Th·ªùi gian ch·ªù k·∫øt n·ªëi (gi√¢y)</label>
                   <input type="range" min="5" max="30" value="10">
                   <span>10 gi√¢y</span>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">T·ª± ƒë·ªông k·∫øt n·ªëi l·∫°i</div>
                       <div class="setting-desc">T·ª± ƒë·ªông th·ª≠ k·∫øt n·ªëi l·∫°i khi m·∫•t k·∫øt n·ªëi</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
           </div>
           
           <div class="setting-group">
               <h4>Hi·ªÉn th·ªã</h4>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">Hi·ªÉn th·ªã thi·∫øt b·ªã offline</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
               
               <div class="setting-item">
                   <div class="setting-info">
                       <div class="setting-label">Nh√≥m theo ph√≤ng</div>
                   </div>
                   <label class="switch">
                       <input type="checkbox" checked>
                       <span class="slider-switch"></span>
                   </label>
               </div>
           </div>
           
           <div class="device-actions">
               <button class="btn btn-outline btn-full" onclick="scanForDevices()">
                   <span class="material-icons">refresh</span>
                   Qu√©t thi·∫øt b·ªã m·ªõi
               </button>
               
               <button class="btn btn-outline btn-full" onclick="resetAllDevices()">
                   <span class="material-icons">settings_backup_restore</span>
                   ƒê·∫∑t l·∫°i t·∫•t c·∫£ thi·∫øt b·ªã
               </button>
           </div>
       </div>
   </div>
</div>

<!-- Automation Rule Builder Modal -->
<div id="automation-rule-builder-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>T·∫°o quy t·∫Øc t·ª± ƒë·ªông</h3>
   </div>
   <div class="modal-content" id="rule-builder-content">
       <!-- Content will be populated by JS -->
   </div>
</div>

<!-- Security Settings Modal -->
<div id="security-settings-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>B·∫£o m·∫≠t 2 l·ªõp</h3>
   </div>
   <div class="modal-content">
       <div class="security-settings">
           <div class="setting-item">
               <div class="setting-info">
                   <div class="setting-label">B·∫≠t x√°c th·ª±c 2 l·ªõp</div>
                   <div class="setting-desc">S·ª≠ d·ª•ng SMS ho·∫∑c app x√°c th·ª±c</div>
               </div>
               <label class="switch">
                   <input type="checkbox" onchange="toggle2FA(this.checked)">
                   <span class="slider-switch"></span>
               </label>
           </div>
           
           <div class="setting-item">
               <div class="setting-info">
                   <div class="setting-label">Kh√≥a ·ª©ng d·ª•ng</div>
                   <div class="setting-desc">Y√™u c·∫ßu PIN ho·∫∑c v√¢n tay khi m·ªü app</div>
               </div>
               <label class="switch">
                   <input type="checkbox" onchange="toggleAppLock(this.checked)">
                   <span class="slider-switch"></span>
               </label>
           </div>
           
           <div class="session-management">
               <h4>Qu·∫£n l√Ω phi√™n ƒëƒÉng nh·∫≠p</h4>
               <div class="session-list">
                   <div class="session-item">
                       <div class="session-info">
                           <div class="session-device">iPhone 15 Pro</div>
                           <div class="session-location">H√† N·ªôi, Vi·ªát Nam</div>
                           <div class="session-time">ƒêang ho·∫°t ƒë·ªông</div>
                       </div>
                       <span class="session-current">Hi·ªán t·∫°i</span>
                   </div>
               </div>
               
               <button class="btn btn-outline btn-full" onclick="logoutAllDevices()">
                   ƒêƒÉng xu·∫•t t·∫•t c·∫£ thi·∫øt b·ªã
               </button>
           </div>
       </div>
   </div>
</div>

<!-- Backup & Restore Modal -->
<div id="backup-restore-modal" class="modal">
   <div class="modal-header">
       <button class="back-btn" onclick="closeModal()">
           <span class="material-icons">arrow_back</span>
       </button>
       <h3>Sao l∆∞u & kh√¥i ph·ª•c</h3>
   </div>
   <div class="modal-content">
       <div class="backup-settings">
           <div class="backup-status">
               <div class="status-info">
                   <h4>Sao l∆∞u g·∫ßn nh·∫•t</h4>
                   <p>15/06/2025, 14:30</p>
                   <span class="status-success">Th√†nh c√¥ng</span>
               </div>
               <button class="btn btn-primary" onclick="createBackup()">
                   Sao l∆∞u ngay
               </button>
           </div>
           
           <div class="setting-item">
               <div class="setting-info">
                   <div class="setting-label">T·ª± ƒë·ªông sao l∆∞u</div>
                   <div class="setting-desc">Sao l∆∞u h√†ng ng√†y l√™n cloud</div>
               </div>
               <label class="switch">
                   <input type="checkbox" checked>
                   <span class="slider-switch"></span>
               </label>
           </div>
           
           <div class="backup-options">
               <h4>D·ªØ li·ªáu sao l∆∞u</h4>
               
               <div class="backup-item">
                   <label class="checkbox">
                       <input type="checkbox" checked>
                       <span class="checkmark"></span>
                       C√†i ƒë·∫∑t thi·∫øt b·ªã
                   </label>
               </div>
               
               <div class="backup-item">
                   <label class="checkbox">
                       <input type="checkbox" checked>
                       <span class="checkmark"></span>
                       K·ªãch b·∫£n & quy t·∫Øc
                   </label>
               </div>
               
               <div class="backup-item">
                   <label class="checkbox">
                       <input type="checkbox" checked>
                       <span class="checkmark"></span>
                       D·ªØ li·ªáu th·ªëng k√™
                   </label>
               </div>
               
               <div class="backup-item">
                   <label class="checkbox">
                       <input type="checkbox">
                       <span class="checkmark"></span>
                       L·ªãch s·ª≠ th√¥ng b√°o
                   </label>
               </div>
           </div>
           
           <div class="restore-section">
               <h4>Kh√¥i ph·ª•c</h4>
               <input type="file" id="restore-file" accept=".json" style="display: none;">
               <button class="btn btn-outline btn-full" onclick="selectRestoreFile()">
                   Ch·ªçn file sao l∆∞u
               </button>
           </div>
       </div>
   </div>
</div>
</body>
</html>