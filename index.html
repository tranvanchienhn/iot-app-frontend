<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHome IoT - B√¨nh n∆∞·ªõc n√≥ng & M√°y s·∫•y khƒÉn</title>
    
    <!-- Meta tags -->
    <meta name="description" content="·ª®ng d·ª•ng ƒëi·ªÅu khi·ªÉn b√¨nh n∆∞·ªõc n√≥ng v√† m√°y s·∫•y khƒÉn th√¥ng minh">
    <meta name="keywords" content="smart home, iot, b√¨nh n∆∞·ªõc n√≥ng, m√°y s·∫•y khƒÉn">
    <meta name="author" content="SmartHome IoT">
    
    <!-- PWA Meta -->
    <meta name="theme-color" content="#2196F3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SmartHome">
    
    <!-- Links -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="js/utils.js" as="script">
    <link rel="preload" href="js/data.js" as="script">
</head>
<body class="theme-light">
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <div class="logo">
                <div class="logo-icon">üè†</div>
                <h1>SmartHome IoT</h1>
                <p>B√¨nh n∆∞·ªõc n√≥ng & M√°y s·∫•y khƒÉn</p>
            </div>
            <div class="loading">
                <div class="loading-spinner"></div>
                <p id="loading-message">ƒêang kh·ªüi ƒë·ªông...</p>
            </div>
            <div class="version">Phi√™n b·∫£n 1.2.3</div>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="auth-container" class="auth-container hidden">
        <!-- Login Screen -->
        <div id="login-screen" class="auth-screen active">
            <div class="auth-header">
                <h2>ƒêƒÉng nh·∫≠p</h2>
            </div>
            <div class="auth-content">
                <div class="logo-section">
                    <div class="auth-logo">üè†</div>
                    <h3>Ch√†o m·ª´ng tr·ªü l·∫°i!</h3>
                    <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ ƒëi·ªÅu khi·ªÉn thi·∫øt b·ªã c·ªßa b·∫°n</p>
                </div>
                <form class="auth-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="login-email">Email ho·∫∑c s·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" id="login-email" placeholder="example@email.com" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="login-password">M·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                            <button type="button" class="toggle-password" onclick="togglePassword('login-password')" aria-label="Hi·ªán/·∫®n m·∫≠t kh·∫©u">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="remember-me">
                            <span class="checkmark"></span>
                            <span>Ghi nh·ªõ ƒëƒÉng nh·∫≠p</span>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">ƒêƒÉng nh·∫≠p</button>
                </form>
                <div class="auth-links">
                    <a href="#" onclick="showAuthScreen('signup')">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</a>
                    <a href="#" onclick="showAuthScreen('forgot-password')">Qu√™n m·∫≠t kh·∫©u?</a>
                </div>
            </div>
        </div>

        <!-- Signup Screen -->
        <div id="signup-screen" class="auth-screen">
            <div class="auth-header">
                <button class="back-btn" onclick="showAuthScreen('login')" aria-label="Quay l·∫°i">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>T·∫°o t√†i kho·∫£n</h2>
            </div>
            <div class="auth-content">
                <form class="auth-form" onsubmit="handleSignup(event)">
                    <div class="form-group">
                        <label for="signup-name">H·ªç v√† t√™n</label>
                        <input type="text" id="signup-name" placeholder="Nguyen Van A" required autocomplete="name">
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="example@email.com" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="signup-phone">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" id="signup-phone" placeholder="+84 901234567" required autocomplete="tel">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">M·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="signup-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password">
                            <button type="button" class="toggle-password" onclick="togglePassword('signup-password')" aria-label="Hi·ªán/·∫®n m·∫≠t kh·∫©u">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar">
                                <div class="strength-fill" id="password-strength-fill"></div>
                            </div>
                            <div class="strength-text" id="password-strength-text">Nh·∫≠p m·∫≠t kh·∫©u</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="signup-confirm">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                        <div class="password-input">
                            <input type="password" id="signup-confirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password">
                            <button type="button" class="toggle-password" onclick="togglePassword('signup-confirm')" aria-label="Hi·ªán/·∫®n m·∫≠t kh·∫©u">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="agree-terms" required>
                            <span class="checkmark"></span>
                            <span>T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" onclick="showTerms()">ƒêi·ªÅu kho·∫£n</a> v√† <a href="#" onclick="showPrivacy()">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></span>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">T·∫°o t√†i kho·∫£n</button>
                </form>
            </div>
        </div>

        <!-- Forgot Password Screen -->
        <div id="forgot-password-screen" class="auth-screen">
            <div class="auth-header">
                <button class="back-btn" onclick="showAuthScreen('login')" aria-label="Quay l·∫°i">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2>Qu√™n m·∫≠t kh·∫©u</h2>
            </div>
            <div class="auth-content">
                <div class="logo-section">
                    <div class="auth-logo">üîë</div>
                    <h3>Kh√¥i ph·ª•c m·∫≠t kh·∫©u</h3>
                    <p>Nh·∫≠p email ƒë·ªÉ nh·∫≠n m√£ x√°c nh·∫≠n kh√¥i ph·ª•c m·∫≠t kh·∫©u</p>
                </div>
                <form class="auth-form" onsubmit="handleForgotPassword(event)">
                    <div class="form-group">
                        <label for="forgot-email">Email</label>
                        <input type="email" id="forgot-email" placeholder="example@email.com" required autocomplete="email">
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">G·ª≠i m√£ x√°c nh·∫≠n</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="app-container hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="home-selector" onclick="showHomeSelector()" role="button" tabindex="0">
                    <span id="current-home-name">Nh√† ri√™ng</span>
                    <span class="material-icons">keyboard_arrow_down</span>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="showNotifications()" aria-label="Th√¥ng b√°o">
                    <span class="material-icons">notifications</span>
                    <span class="badge hidden" id="notification-badge">0</span>
                </button>
                <button class="header-btn voice-btn" onclick="startVoiceControl()" aria-label="ƒêi·ªÅu khi·ªÉn gi·ªçng n√≥i">
                    <span class="material-icons">mic</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Screen -->
            <div id="home-screen" class="screen active">
                <!-- Weather Widget -->
                <div class="weather-widget">
                    <div class="weather-info">
                        <span class="weather-icon">‚òÄÔ∏è</span>
                        <div class="weather-details">
                            <div class="temperature">28¬∞C</div>
                            <div class="location">H√† N·ªôi, H√¥m nay</div>
                            <div class="description">N·∫Øng, gi√≥ nh·∫π</div>
                        </div>
                    </div>
                </div>

                <!-- Device Status Cards -->
                <section class="section">
                    <h3 class="section-title">Thi·∫øt b·ªã c·ªßa b·∫°n</h3>
                    <div class="device-status-grid" id="device-status-cards">
                        <!-- Devices will be populated by JS -->
                    </div>
                </section>

                <!-- Quick Actions -->
                <section class="section">
                    <h3 class="section-title">Thao t√°c nhanh</h3>
                    <div class="quick-actions-grid">
                        <button class="quick-action-btn" onclick="quickHeatWater(45)" data-action="heat-water">
                            <span class="action-icon">üöø</span>
                            <span class="action-text">ƒêun n∆∞·ªõc 45¬∞C</span>
                        </button>
                        <button class="quick-action-btn" onclick="quickStartTowelDrying()" data-action="towel-dry">
                            <span class="action-icon">üëï</span>
                            <span class="action-text">S·∫•y khƒÉn</span>
                        </button>
                        <button class="quick-action-btn" onclick="quickStartRoomHeating()" data-action="room-heat">
                            <span class="action-icon">üî•</span>
                            <span class="action-text">S∆∞·ªüi ph√≤ng</span>
                        </button>
                        <button class="quick-action-btn" onclick="runPresetScene('bath-ready')" data-action="bath-scene">
                            <span class="action-icon">üõÄ</span>
                            <span class="action-text">Chu·∫©n b·ªã t·∫Øm</span>
                        </button>
                    </div>
                </section>

                <!-- Today's Summary -->
                <section class="section">
                    <h3 class="section-title">T·ªïng quan h√¥m nay</h3>
                    <div class="summary-cards" id="summary-cards">
                        <!-- Summary will be populated by JS -->
                    </div>
                </section>
            </div>

            <!-- Devices Screen -->
            <div id="devices-screen" class="screen">
                <div class="screen-header">
                    <h2>Thi·∫øt b·ªã</h2>
                    <div class="header-actions">
                        <button class="header-btn" onclick="refreshDevices()" aria-label="L√†m m·ªõi">
                            <span class="material-icons">refresh</span>
                        </button>
                    </div>
                </div>

                <div class="device-list" id="device-list">
                    <!-- Devices will be populated by JS -->
                </div>
            </div>

            <!-- Analytics Screen -->
            <div id="analytics-screen" class="screen">
                <div class="screen-header">
                    <h2>Th·ªëng k√™ nƒÉng l∆∞·ª£ng</h2>
                </div>

                <!-- Period Selector -->
                <div class="period-selector">
                    <button class="period-btn active" onclick="setPeriod('today')" data-period="today">H√¥m nay</button>
                    <button class="period-btn" onclick="setPeriod('week')" data-period="week">Tu·∫ßn</button>
                    <button class="period-btn" onclick="setPeriod('month')" data-period="month">Th√°ng</button>
                </div>

                <!-- Analytics Overview -->
                <div class="analytics-overview" id="analytics-overview">
                    <!-- Analytics will be populated by JS -->
                </div>

                <!-- Chart Container -->
                <div class="chart-container">
                    <canvas id="energy-chart" width="400" height="200"></canvas>
                </div>

                <!-- Device Analytics -->
                <section class="section">
                    <h3 class="section-title">Thi·∫øt b·ªã ti√™u th·ª• nhi·ªÅu nh·∫•t</h3>
                    <div class="device-analytics" id="device-analytics">
                        <!-- Device analytics will be populated by JS -->
                    </div>
                </section>
            </div>

            <!-- Settings Screen -->
            <div id="settings-screen" class="screen">
                <div class="screen-header">
                    <h2>C√†i ƒë·∫∑t</h2>
                </div>

                <!-- Profile Section -->
                <div class="profile-section">
                    <div class="profile-info">
                        <div class="profile-avatar" id="profile-avatar">
                            <span class="material-icons">person</span>
                        </div>
                        <div class="profile-details">
                            <div class="profile-name" id="profile-name">Ng∆∞·ªùi d√πng</div>
                            <div class="profile-email" id="profile-email">user@example.com</div>
                        </div>
                    </div>
                </div>

                <!-- Settings Groups -->
                <div class="settings-groups">
                    <div class="settings-group">
                        <h4 class="group-title">Thi·∫øt b·ªã & H·ªá th·ªëng</h4>
                        <div class="setting-item" onclick="showDeviceSettings()">
                            <span class="material-icons">devices</span>
                            <span class="setting-label">Qu·∫£n l√Ω thi·∫øt b·ªã</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showNotificationSettings()">
                            <span class="material-icons">notifications</span>
                            <span class="setting-label">Th√¥ng b√°o</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showVoiceSettings()">
                            <span class="material-icons">mic</span>
                            <span class="setting-label">ƒêi·ªÅu khi·ªÉn gi·ªçng n√≥i</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">Giao di·ªán</h4>
                        <div class="setting-item" onclick="showThemeSettings()">
                            <span class="material-icons">palette</span>
                            <span class="setting-label">Ch·∫ø ƒë·ªô s√°ng/t·ªëi</span>
                            <div class="setting-value">
                                <select id="theme-selector" onchange="changeTheme(this.value)">
                                    <option value="light">S√°ng</option>
                                    <option value="dark">T·ªëi</option>
                                    <option value="auto">T·ª± ƒë·ªông</option>
                                </select>
                            </div>
                        </div>
                        <div class="setting-item" onclick="showLanguageSettings()">
                            <span class="material-icons">language</span>
                            <span class="setting-label">Ng√¥n ng·ªØ</span>
                            <span class="setting-value">Ti·∫øng Vi·ªát</span>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h4 class="group-title">H·ªó tr·ª£</h4>
                        <div class="setting-item" onclick="showHelp()">
                            <span class="material-icons">help</span>
                            <span class="setting-label">H∆∞·ªõng d·∫´n</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                        <div class="setting-item" onclick="showAbout()">
                            <span class="material-icons">info</span>
                            <span class="setting-label">V·ªÅ ·ª©ng d·ª•ng</span>
                            <span class="material-icons">chevron_right</span>
                        </div>
                    </div>
                </div>

                <!-- Version & Logout -->
                <div class="settings-footer">
                    <div class="version-info">Phi√™n b·∫£n 1.2.3</div>
                    <button class="btn btn-danger btn-full" onclick="logout()">
                        ƒêƒÉng xu·∫•t
                    </button>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav" role="navigation">
            <button class="nav-item active" onclick="showScreen('home')" data-screen="home" aria-label="Trang ch·ªß">
                <span class="material-icons">home</span>
                <span class="nav-label">Trang ch·ªß</span>
            </button>
            <button class="nav-item" onclick="showScreen('devices')" data-screen="devices" aria-label="Thi·∫øt b·ªã">
                <span class="material-icons">devices</span>
                <span class="nav-label">Thi·∫øt b·ªã</span>
            </button>
            <button class="nav-item" onclick="showScreen('analytics')" data-screen="analytics" aria-label="Th·ªëng k√™">
                <span class="material-icons">analytics</span>
                <span class="nav-label">Th·ªëng k√™</span>
            </button>
            <button class="nav-item" onclick="showScreen('settings')" data-screen="settings" aria-label="C√†i ƒë·∫∑t">
                <span class="material-icons">settings</span>
                <span class="nav-label">C√†i ƒë·∫∑t</span>
            </button>
        </nav>
    </div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay" onclick="closeModalOnOverlayClick(event)">
        <!-- Device Control Modal -->
        <div id="device-control-modal" class="modal">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal()" aria-label="ƒê√≥ng">
                    <span class="material-icons">close</span>
                </button>
                <h3 id="device-control-title">ƒêi·ªÅu khi·ªÉn thi·∫øt b·ªã</h3>
                <button class="header-btn" onclick="showDeviceOptions()" aria-label="T√πy ch·ªçn">
                    <span class="material-icons">more_vert</span>
                </button>
            </div>
            <div class="modal-content" id="device-control-content">
                <!-- Content will be populated by JS -->
            </div>
        </div>

        <!-- Notifications Modal -->
        <div id="notifications-modal" class="modal">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal()" aria-label="ƒê√≥ng">
                    <span class="material-icons">close</span>
                </button>
                <h3>Th√¥ng b√°o</h3>
                <button class="header-btn" onclick="clearAllNotifications()" aria-label="X√≥a t·∫•t c·∫£">
                    <span class="material-icons">clear_all</span>
                </button>
            </div>
            <div class="modal-content">
                <div class="notifications-list" id="notifications-list">
                    <!-- Notifications will be populated by JS -->
                </div>
            </div>
        </div>

        <!-- Loading Modal -->
        <div id="loading-modal" class="modal loading-modal">
            <div class="loading-content">
                <div class="loading-spinner large"></div>
                <p id="loading-text">ƒêang x·ª≠ l√Ω...</p>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmation-modal" class="modal confirmation-modal">
            <div class="confirmation-content">
                <div class="confirmation-icon" id="confirmation-icon">
                    <span class="material-icons">help</span>
                </div>
                <h3 id="confirmation-title">X√°c nh·∫≠n</h3>
                <p id="confirmation-message">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
                <div class="confirmation-actions">
                    <button class="btn btn-outline" onclick="closeModal()">H·ªßy</button>
                    <button class="btn btn-primary" id="confirmation-confirm" onclick="confirmAction()">X√°c nh·∫≠n</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container" aria-live="polite"></div>

    <!-- Voice Control Overlay -->
    <div id="voice-overlay" class="voice-overlay">
        <div class="voice-content">
            <div class="voice-animation">
                <div class="voice-wave"></div>
                <div class="voice-wave"></div>
                <div class="voice-wave"></div>
            </div>
            <h3>ƒêang nghe...</h3>
            <p id="voice-transcript">H√£y n√≥i l·ªánh c·ªßa b·∫°n</p>
            <button class="btn btn-outline" onclick="stopVoiceControl()">D·ª´ng</button>
        </div>
    </div>

    <!-- PWA Install Prompt -->
    <div id="install-prompt" class="install-prompt">
        <div class="install-content">
            <span class="material-icons">get_app</span>
            <div class="install-text">
                <h4>C√†i ƒë·∫∑t SmartHome IoT</h4>
                <p>Truy c·∫≠p nhanh h∆°n t·ª´ m√†n h√¨nh ch√≠nh</p>
            </div>
            <div class="install-actions">
                <button class="btn btn-text btn-sm" onclick="dismissInstall()">B·ªè qua</button>
                <button class="btn btn-primary btn-sm" onclick="installPWA()">C√†i ƒë·∫∑t</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>